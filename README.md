# Yamusic-dl

Консольная утилита для скачивания музыки из Яндекс Музыки.

## Описание

Yamusic-dl позволяет скачивать треки из Яндекс Музыки с помощью API сервиса. Утилита поддерживает различные уровни качества и сохраняет файлы в формате M4A с метаданными исполнителя и названия трека.

## Возможности

- Скачивание треков по ID или url
- Поддержка различных уровней качества (min, normal, max)
- Встроенная утилита для получения токена доступа

## Установка

### Требования

- Go 1.16 или выше

### Сборка из исходников

```bash
git clone https://github.com/Kud1nov/yamusic-dl.git
cd yamusic-dl
go build -o bin/yamusic-dl ./cmd/downloader
go build -o bin/yamusic-auth ./cmd/authorizer
```

## Использование

### Получение токена доступа

Перед скачиванием музыки вам необходимо получить токен доступа:

```bash
./bin/yamusic-auth [-verbose]
```

Утилита проведет вас через процесс авторизации. Если запрашивается CAPTCHA, следуйте инструкциям в консоли:
1. Перейдите по указанной ссылке в браузере
2. Пройдите CAPTCHA и завершите процесс авторизации
3. Откройте инструменты разработчика (F12) и найдите токен в исходном коде или выполните предложенную команду в консоли браузера

### Скачивание музыки

```bash
./bin/yamusic-dl -track <ID трека или URL> -token <токен доступа> [опции]
```

### Обязательные параметры

- `-track`: ID трека или URL Яндекс Музыки
- `-token`: Токен доступа к API Яндекс Музыки (полученный через yamusic-auth)

### Опциональные параметры

- `-quality`: Качество трека (min, normal, max), по умолчанию: max
- `-output`: Директория для сохранения файлов, по умолчанию: текущая директория
- `-verbose`: Вывод отладочных сообщений

### Примеры

Скачать трек по прямой ссылке с максимальным качеством:
```bash
./bin/yamusic-dl -track "https://music.yandex.ru/album/10555/track/32988399" -token YOUR_TOKEN
```

Скачать трек с обычным качеством в определенную директорию:
```bash
./bin/yamusic-dl -track 32988399 -token YOUR_TOKEN -quality normal -output ~/Music
```

## Архитектура проекта

```
yamusic-dl/
├── cmd/               # Точка входа в приложение
│   ├── downloader/    # Главный файл приложения для скачивания музыки
│   └── authorizer/    # Утилита для получения Access Token
├── internal/          # Внутренние пакеты, не экспортируемые вне проекта
│   ├── api/           # Модели данных и константы для API
│   ├── crypto/        # Функции для криптографических операций
│   ├── logger/        # Унифицированная система логирования
│   └── utils/         # Вспомогательные функции
└── pkg/               # Публичные пакеты, которые могут использоваться другими проектами
    └── yamusic/       # Клиент для работы с API Яндекс Музыки
```

### Модули

- **cmd/downloader**: Точка входа, обработка аргументов командной строки для скачивания музыки
- **cmd/authorizer**: Утилита для получения Access Token через OAuth авторизацию
- **internal/api**: Модели данных и константы для работы с API
- **internal/crypto**: Функции для шифрования и дешифрования данных
- **internal/logger**: Унифицированная система логирования с уровнями детализации
- **internal/utils**: Вспомогательные функции для работы с файлами и URL
- **pkg/yamusic**: Клиент для работы с API Яндекс Музыки

## Лицензия

MIT

## Получение токена Яндекс Музыки

Существует несколько способов получить токен доступа к API Яндекс Музыки:

### Через yamusic-auth (рекомендуется)

Запустите утилиту `yamusic-auth` и следуйте инструкциям в консоли.

### Через приложение Яндекс Музыки

1. Установите и авторизуйтесь в приложении Яндекс Музыка
2. Настройте прокси на вашем устройстве (например, через Charles или Fiddler)
3. Прослушайте трафик приложения
4. Найдите запросы к `api.music.yandex.net`
5. В заголовках запроса найдите токен в поле `Authorization`

### Дополнительная информация

https://yandex-music.readthedocs.io/en/main/token.html

## Отказ от ответственности

Данная утилита разработана исключительно в образовательных и ознакомительных целях для демонстрации принципов работы с API и шифрования данных. 

**ВАЖНО:**
- Проект не предназначен для нарушения авторских прав или обхода технических средств защиты контента.
- Скачивание треков может нарушать условия использования сервиса Яндекс Музыка, а также законодательство вашей страны.
- Автор не несет ответственности за любое неправомерное использование данной утилиты.
- Использование данного программного обеспечения осуществляется на ваш страх и риск.
- Перед использованием убедитесь, что ваши действия соответствуют законодательству вашей страны и условиям использования сервисов Яндекс.

Рекомендуется использовать утилиту только для изучения принципов программирования и работы API, без фактического скачивания защищенного авторским правом контента.
